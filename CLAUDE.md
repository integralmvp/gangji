# CLAUDE.md — Gangji (갱지) 프로젝트 기준 문서
> **목적**: 이 문서는 Gangji를 “본질 그대로” 구현하기 위한 **최종 기준(레일)**이다.  
> 앞으로의 모든 개발/리팩토링/출시는 이 문서를 기준으로 **일관되게** 진행한다.

---

## 1) 정체성 · 철학 · 지향점

### 1.1 Gangji(갱지)란?
- Gangji는 **생산성 도구(플래너/할일앱)**가 아니다.
- Gangji는 **“흐름(Flow)을 다루기 위한 개인 OS”**다.
- 사용자는 **정해진 틀을 채우지 않는다.**  
  사용자는 **백지를 펼치고 즉시 기록한다.**  
  구조(정리/분류/회고/계획)는 **나중에** 생긴다.

### 1.2 핵심 원칙(변경 불가)
- **Execute first, organize later** (선실행 후계획/후정리)
- **Zero friction / Zero pressure / Zero guilt**
  - 입력 강제 없음, 미작성 페널티 없음, 실패/경고 UI 없음
  - 사용자가 “비는 칸”을 보며 죄책감을 느끼게 하는 UI 금지
- 사용자는 **일(日) 단위가 아니라 “몰입 주기”**로 움직인다.

---

## 2) 행동 엔진: RUN → STAND → SIT (가장 중요, 절대 고정)

### 2.1 Flow Cycle 정의
- **RUN(달리기)**: 몰입/실행/출력(제약 최소)
- **STAND(서기)**: 달린 후 복기/정리/다음 달리기 계획(연결)
- **SIT(앉기)**: 휴식/저에너지 허용(압박 제거)

> 이 사이클은 선택 옵션이 아니라 **시스템의 핵심 동작 엔진**이다.

### 2.2 몰입기간(Immersion Period)
- Gangji의 계획/운영 단위는 “하루”가 아니라 **“기간(Period)”**이다.
- 사용자는 **테마 기반 몰입 기간**을 설정하고,
- 그 기간을 **RUN/STAND/SIT 기간 조합**으로 운영한다.
- 달력은 “일정표”가 아니라 **흐름 지도(Flow Map)**다.

---

## 3) 제품 경험의 핵심 UX: “백지 → 흐름”

### 3.1 사용자 핵심 플로우
1. **백지 펼치기**
2. **즉시 작성(커서 자동 포커스)**
3. **자동 저장(무의식 저장)**
4. **달력에서 ‘흔적(존재)’ 확인**
5. **몰입기간(RUN/STAND/SIT)로 흐름을 운영**

### 3.2 Gangji가 거부하는 UX
- 할 일/완료율/스트릭/목표 달성률/붉은 경고/미작성 알림  
→ **전부 금지**

---

## 4) UI/UX 기준(구체 설계)

### 4.1 전체 레이아웃(고정)
- **Landing(메인)**: 중앙 **약 80%** 영역에 3개월 달력
- **LeftNav**: 좌측 세로 네비게이션(탭/포스트잇 느낌)
- **TopBar**: 상단에 날짜 + 뷰 전환(달력↔백지)
- **Bottom**: 하단 몰입기간(Flow) 관리 섹션

```

┌───────────────────────────────────────────────────────────┐
│ TopBar: 날짜 / [달력]↔[백지] 전환 / (선택: 현재 테마)      │
├───────────────┬───────────────────────────────────────────┤
│ LeftNav        │ Main(≈80%)                                │
│ - Recent       │ ① Calendar View (3개월)                   │
│ - Tabs         │ ② Blank Editor (백지)                     │
│ - Tags(보관소) │                                           │
│ - Bookmarks    │                                           │
│ - Search       │                                           │
├───────────────┴───────────────────────────────────────────┤
│ Bottom Flow Section: 몰입기간(테마/주간 RUN-STAND-SIT)      │
└───────────────────────────────────────────────────────────┘

```

---

### 4.2 Calendar View(달력) — “계획표가 아닌 흐름 지도”
**표시해야 하는 것**
- 📄 **백지 기록 존재**(그날 기록이 있음을 표시)
- 🚩 **몰입 테마(기간)** 표시(깃발 + 범위 하이라이트)
- 🧍/🏃/🪑 **기간 타입(RUN/STAND/SIT)** 표시(기간 단위)

**표시하지 말아야 하는 것**
- 빈 날 경고/빨간 표시/미작성 부채감 UI 금지

**색상/표시 로직(중요)**
- **무채색(회색) = 계획/할당 상태**
- **유채색 = 실제 상호작용이 있었음(흔적)**
- “완료”가 아니라 **“존재(presence)”**를 시각화한다.

**동작**
- 날짜 클릭 → 해당 날짜의 Page(또는 Bundle) 열기 → 자동으로 에디터 뷰 전환
- 해당 날짜 기록이 없으면 → **즉시 생성**(마찰 없이)

---

### 4.3 Blank Editor(백지) — “즉시 쓰기”
**진입**
- TopBar의 **[백지 펼치기]** 또는 날짜 클릭으로 진입
- **중간 단계/모달/폼 금지**
- 열리자마자 **커서 자동 포커스**, 1초 내 타이핑 가능

**작성**
- 사용자는 “일반 언어”로 쓴다(마크다운 강제 금지)
- 시스템 내부 저장은 구조화된 포맷(리치텍스트)로 유지
- 1장 당 A4 문서 규격 단위로 작성(추후 인쇄 기능 추가)

**자동 저장**
- 저장 버튼 없음
- 500ms 내 디바운스 자동 저장
- 앱 재실행/새로고침에도 복원

**메타데이터(선택/차단 금지)**
- title(무제 허용)
- tabs(복수 선택)
- tags(복수 선택, 보관소)
- bookmark 토글
- 이어쓰기(묶음) 토글

**이어쓰기(Bundle)**
- 한 번의 작성 흐름이 여러 장(페이지)로 이어질 수 있음
- 이어진 페이지는 **한 묶음(Bundle)**으로 관리(목록/네비게이션 단위)

---

### 4.4 LeftNav(페이지 관리) — “정리는 나중”
초기 MVP에서는 UI 뼈대 + 핵심만 우선 구현한다.
- Recent(최근 기록 묶음/페이지)
- Tabs(탭 트리) : 한 페이지 당 하나 이상의 탭 설정 가능 / 플랫폼 기본 고정 탭 몰입탭(stand/run/sit 세개의 하위 탭)
- Tags(보관소: 태그 클라우드/목록)
- Bookmarks(북마크 목록)
- Search(단순 검색 → 고도화는 Phase B)
- 페이지 쪽수 관리

---

### 4.5 Bottom Flow Section(몰입기간 관리) — “제어 레이어”
**기능**
- 사용자가 직접 몰입 테마/기간 설정
- 사용자가 지정한 날짜, 기간으로 RUN/STAND/SIT 설정
- 각 RUN/STAND/SIT 에 목표 1줄 설정
- 호버/클릭 시 주간 설명/목표 노출

**UI 구성**
1) **Current Flow Card**
- theme / 기간 / 현재 기간 타입 / 목표(1줄)
- 수정 / 종료 / 새 몰입

2) **Flow Strip**
- 예: `[ STAND ][ RUN ][ RUN ][ SIT ]`
- hover: 기간 정보(기간/목표)
- click: 기간 편집(타입 3개 + 목표 1줄)

---

## 5) 디자인 언어(갱지 감성) 기준
- 컨셉: **갱지 무지노트의 아날로그 감성**, 가볍고 산뜻
- 배경: 따뜻한 베이지/종이 톤 (예: `#F5E9DA` 계열)
- 텍스트: 다크 브라운 계열
- 포인트: 형광펜(하이라이트) 중심
- LeftNav: 노트 탭/포스트잇 스타일
- 금지: 대시보드 느낌, 강한 테크 UI, 과한 차트/경고/빨강 페널티

---

## 6) 문서 작업 보조 툴(에디터 최소 필수)
> “입력 장벽을 올리지 않으면서도 문서 작성이 가능해야 함”

**필수(Phase A부터)**
- 굵게/기울임/밑줄
- 말머리/제목(H1~H3) *(폰트 크기 직접 조절 대신)*
- 글머리표/번호 목록
- 텍스트 색상(제한된 팔레트 6~8)
- 형광펜(Highlight) — **시그니처 기능**
- 빠른 기호 삽입(• → ✓ ★ 등)

**UX 방식**
- 기본은 미니(숨김)
- 텍스트 선택 시 BubbleMenu
- 문단 시작 또는 `/` 입력 시 슬래시 커맨드(선택)

**금지(초기)**
- 폰트 선택(다중 폰트)
- 폰트 크기 자유 조절 UI
- 표/이미지 업로드(Phase A 제외)

---

## 7) 기술 스택 & 구조(로컬 퍼스트 + 향후 PC/모바일)
### 7.1 고정 스택(Phase A)
- Next.js(App Router) + TypeScript
- TailwindCSS
- Zustand
- IndexedDB(Dexie)
- TipTap

### 7.2 로컬 퍼스트 원칙(협상 불가)
- 서버 없음, 로그인 없음, 인증 없음
- 데이터는 로컬 저장, 사용자가 완전 소유

### 7.3 StorageAdapter(필수) — 추후 확장 대비
- 앱 로직은 저장소에 직접 의존 금지
- **StorageAdapter 인터페이스**로만 접근
- 현재 구현: IndexedDB(Dexie)
- 향후 구현(구조만 열어둠): Desktop(Tauri)+SQLite / Mobile(Capacitor)+SQLite / File-based

### 7.4 데이터 유지(실사용 + 개발 병행)
- Dexie **versioning + migration scaffold** 필수
- content 포맷: **TipTap JSON 고정**
- 최소 안전장치: **Export(JSON)**
  - 개발 중에도 사용자 데이터 유실 방지
  - Import는 Phase B에서 구현 가능

---

## 8) 데이터 모델(기준)
- Page: 날짜 기반 기록 단위(내부 단위)
- Bundle: 이어쓰기/연속 기록의 관리 단위(**UI 기준 단위**)
- Sprint: 몰입 테마/기간 배열
- Period: run/stand/sit + 목표(1줄) + startDate

> Page는 “낱장”, Bundle은 “묶음(실사용 단위)”.

---

## 9) 개발 → 출시 청사진(전체 로드맵)
### Phase A: Local MVP (즉시 사용, 오늘부터 기록)
- 백지 입력(즉시 타이핑)
- 자동 저장/복원
- 3개월 달력(흔적 표시)
- 몰입기간(RUN/STAND/SIT) 기본 운영
- 에디터 최소 문서 툴 + 하이라이트
- Export(JSON) (최소 안전장치)

### Phase B: 제품 완성도(내구성/편의)
- Tabs/Tags/Bookmarks 실제 필터링 완성
- Search 고도화(제목/본문/태그)
- Export/Import 완성(복구 포함)
- 성능 최적화(페이지 100+에서도 달력/검색 빠르게)
- PWA 안정화(오프라인/설치 경험)

### Phase C: 앱 출시(PC/모바일)
- Desktop: Tauri 쉘 + SQLite Adapter
- Mobile: Capacitor 쉘 + SQLite Adapter
- 연동(동기화)은 “나중”
  - 1차: Export/Import 기반 수동 연동
  - 2차: 폴더/클라우드 기반 동기
  - 3차: 충돌 해결 포함 양방향 Sync 엔진

---

## 10) 개발 시작 목표(“바로 써지는 Gangji” 기준)
**2/16 Definition of Done (필수 5개)**
1. 백지 펼치기 → 즉시 타이핑(커서 자동 포커스)
2. 자동 저장(500ms) + 새로고침/재실행 복원
3. 달력 ↔ 백지 전환
4. 달력에 기록 존재 표시(📄/dot)
5. 몰입기간 생성/표시(RUN/STAND/SIT + 목표 1줄 + 스트립)

> 이 5개가 되면 오늘부터 실사용 시작.

---

## 11) PR 단위 실행 계획(개발 기준)
> 원칙: **작동 우선 → 사용 → 피드백 → 개선**  
> 실사용 데이터는 유지되도록 versioning/Export를 반드시 포함.

### PR1 — 프로젝트 스캐폴딩 & 의존성
- Next.js(App Router), TS, Tailwind, Zustand, Dexie, TipTap 설치
- 폴더 구조 생성(`/components /store /lib/storage /types`)
- 기본 레이아웃 라우팅 준비

### PR2 — Storage Foundation (Adapter + Dexie + Versioning)
- StorageAdapter 인터페이스 정의
- Dexie schema + versioning/migration scaffold
- 기본 CRUD + 날짜 기반 로드 지원

### PR3 — Layout(그릇) + 뷰 전환
- TopBar(날짜/토글) + LeftNav(뼈대) + Main(달력/백지) + Bottom(Flow)
- 달력↔백지 토글 즉시 동작

### PR4 — Blank Editor(핵심) + Auto-save/Restore
- “열자마자 쓰기” 구현(autofocus)
- 500ms debounce auto-save
- 오늘 페이지 자동 생성/로드
- title/메타는 선택(차단 금지)

### PR5 — Calendar(3개월) + 기록 존재 표시 + 날짜 클릭 로드
- 전월/현재/다음월 3개월 표시
- 기록 존재 표시(📄/dot)
- 날짜 클릭 → 해당 페이지(없으면 생성) → 에디터로 전환

### PR6 — Sprint/Flow System(RUN/STAND/SIT) 기본 구현
- 테마/기간 설정
- 기간 스트립(hover/click 편집)
- 달력에 몰입 기간 하이라이트(최소)

### PR7 — Editor Tools(문서 툴) 최소 구현
- Bold/Italic/Underline, Heading, List
- Highlight + Text Color
- BubbleMenu + Slash command(간단)

### PR8 — Export(JSON) 안전장치(최소)
- 전체 데이터 Export(JSON)
- Import는 Phase B에서

---

## 12) 검증 체크리스트(매 PR 공통)
- 앱 열면 **1초 내 작성 가능**
- 저장 버튼 없음 / 입력 차단 없음
- 새로고침 후 데이터 유지
- 달력은 “흔적”만 보여줌(페널티 없음)
- RUN/STAND/SIT 흐름이 UI/데이터에서 깨지지 않음

---

## 13) 절대 금지(재확인)
- todo/체크리스트 중심
- 스트릭/점수/완료율/강제 알림
- 서버/로그인/계정
- 미작성 경고/페널티 UI
- UI에서 한 번에 선택지 3개 초과

---

## 14) 한 문장 정의(팀/코드의 나침반)
**Gangji는 “내 안의 힘(흐름)”을 내가 다루게 만드는, 백지 기반 Flow OS다.**
